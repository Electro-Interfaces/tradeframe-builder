<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>–¢–µ—Å—Ç –∑–∞—â–∏—Ç—ã –æ—Ç Pull-to-Refresh</title>
  
  <!-- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  
  <!-- PWA –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
  <meta name="theme-color" content="#1e293b">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="format-detection" content="telephone=no">
  <meta name="msapplication-tap-highlight" content="no">

  <style>
    /* –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ó–ê–©–ò–¢–ê –û–¢ PULL-TO-REFRESH */
    @media (hover: none) and (pointer: coarse) {
      html, body { 
        overscroll-behavior: none !important;
        overscroll-behavior-y: none !important;
        -webkit-overscroll-behavior: none !important;
        -webkit-overscroll-behavior-y: none !important;
        touch-action: pan-x pan-y !important;
        -webkit-overflow-scrolling: auto !important;
        position: fixed !important;
        overflow: hidden !important;
        width: 100% !important;
        height: 100% !important;
      }

      #app {
        overscroll-behavior: none !important;
        overscroll-behavior-y: none !important;
        -webkit-overscroll-behavior: none !important;
        -webkit-overscroll-behavior-y: none !important;
        touch-action: pan-x pan-y !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        overflow: auto !important;
        -webkit-overflow-scrolling: touch !important;
      }
    }

    /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –¥–ª—è –≤—Å–µ—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤ */
    html, body {
      overscroll-behavior: none;
      overscroll-behavior-y: none;
      -webkit-overscroll-behavior: none;
      -webkit-overscroll-behavior-y: none;
      margin: 0;
      padding: 0;
    }

    #app {
      background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
      color: white;
      padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      min-height: 100vh;
    }

    .status {
      position: fixed;
      top: 10px;
      right: 10px;
      background: rgba(0, 255, 0, 0.2);
      padding: 10px;
      border-radius: 5px;
      font-size: 14px;
    }

    .content {
      margin-top: 60px;
    }

    .item {
      background: rgba(255, 255, 255, 0.1);
      margin: 10px 0;
      padding: 20px;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .log {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0, 0, 0, 0.8);
      color: #00ff00;
      font-family: monospace;
      font-size: 12px;
      max-height: 200px;
      overflow-y: auto;
      padding: 10px;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="status">
      <div>‚úÖ –ó–∞—â–∏—Ç–∞ –∞–∫—Ç–∏–≤–Ω–∞</div>
      <div id="touch-counter">–ö–∞—Å–∞–Ω–∏—è: 0</div>
    </div>
    
    <div class="content">
      <h1>üõ°Ô∏è –¢–µ—Å—Ç –∑–∞—â–∏—Ç—ã –æ—Ç Pull-to-Refresh</h1>
      <p><strong>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</strong></p>
      <ol>
        <li>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ—Ç—è–Ω—É—Ç—å —ç–∫—Ä–∞–Ω –≤–Ω–∏–∑ (pull-to-refresh –∂–µ—Å—Ç)</li>
        <li>–°—Ç—Ä–∞–Ω–∏—Ü–∞ –ù–ï –¥–æ–ª–∂–Ω–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è</li>
        <li>–õ–æ–≥–∏ –≤–Ω–∏–∑—É –ø–æ–∫–∞–∂—É—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è</li>
      </ol>

      <div class="item">
        <h3>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ 1</h3>
        <p>–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ–∫—Ä—É—Ç–∏—Ç—å –∏ –ø–æ—Ç—è–Ω—É—Ç—å –≤–Ω–∏–∑.</p>
      </div>

      <div class="item">
        <h3>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ 2</h3>
        <p>–ï—â–µ –±–æ–ª—å—à–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∫—Ä–æ–ª–ª–∞.</p>
      </div>

      <div class="item">
        <h3>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ 3</h3>
        <p>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –∑–∞—â–∏—Ç—ã.</p>
      </div>

      <div class="item">
        <h3>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ 4</h3>
        <p>–ü–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.</p>
      </div>
    </div>

    <div class="log" id="log">
      <div>üìù –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π:</div>
    </div>
  </div>

  <script>
    let touchCount = 0;
    let startY = 0;
    let logEl = document.getElementById('log');
    
    function addLog(message) {
      const div = document.createElement('div');
      div.textContent = new Date().toLocaleTimeString() + ': ' + message;
      logEl.appendChild(div);
      logEl.scrollTop = logEl.scrollHeight;
    }

    // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç pull-to-refresh
    document.addEventListener('touchstart', (e) => {
      startY = e.touches[0].clientY;
      touchCount++;
      document.getElementById('touch-counter').textContent = `–ö–∞—Å–∞–Ω–∏—è: ${touchCount}`;
      addLog(`TouchStart Y: ${startY.toFixed(0)}`);
    }, { passive: false });
    
    document.addEventListener('touchmove', (e) => {
      const currentY = e.touches[0].clientY;
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      
      // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è —Å–∫—Ä–æ–ª–ª–∏—Ç—å –≤–≤–µ—Ä—Ö –∫–æ–≥–¥–∞ —É–∂–µ –Ω–∞–≤–µ—Ä—Ö—É
      if (scrollTop === 0 && currentY > startY) {
        addLog(`üö´ BLOCKED pull-to-refresh! ScrollTop: ${scrollTop}, StartY: ${startY.toFixed(0)}, CurrentY: ${currentY.toFixed(0)}`);
        e.preventDefault();
        e.stopPropagation();
      }
    }, { passive: false });
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è —Å–∫—Ä–æ–ª–ª–∞
    document.addEventListener('scroll', (e) => {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      if (scrollTop < 0) {
        addLog(`üö´ BLOCKED negative scroll! ScrollTop: ${scrollTop}`);
        window.scrollTo(0, 0);
        e.preventDefault();
        e.stopPropagation();
      }
    }, { passive: false });

    // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥—Ä—É–≥–∏—Ö —Å–æ–±—ã—Ç–∏–π
    window.addEventListener('beforeunload', (e) => {
      addLog('üö® BEFOREUNLOAD triggered!');
    });

    window.addEventListener('unload', (e) => {
      addLog('üö® UNLOAD triggered!');
    });

    addLog('‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç pull-to-refresh –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞');
    addLog('üì± –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ' + navigator.userAgent.includes('Mobile') ? 'Mobile' : 'Desktop');
  </script>
</body>
</html>