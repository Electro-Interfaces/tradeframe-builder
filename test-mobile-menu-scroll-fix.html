<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîß Test Mobile Menu Scroll Fix</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f172a;
            color: white;
            overflow-x: hidden;
        }

        .main-content {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .test-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
            display: block;
            width: 100%;
            max-width: 300px;
        }

        .test-btn:active {
            background: #2563eb;
            transform: scale(0.98);
        }

        /* Overlay */
        .overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 50;
            display: none;
        }

        .overlay.open {
            display: block;
        }

        /* Sidebar —Å –Ω–æ–≤—ã–º–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏ */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 75%;
            max-width: 320px;
            background: #1e293b;
            border-right: 1px solid #475569;
            z-index: 51;

            /* –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –î–õ–Ø –ó–ê–õ–ò–ü–ê–ù–ò–Ø */
            overflow-y: auto;
            overscroll-behavior: none;
            -webkit-overflow-scrolling: touch;
            touch-action: pan-y;
            scroll-behavior: smooth;

            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        .sidebar.open {
            transform: translateX(0);
        }

        .sidebar-content {
            display: flex;
            flex-direction: column;
            height: 100%;
            /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
            overflow-y: auto;
            overscroll-behavior: none;
            -webkit-overflow-scrolling: touch;
            position: relative;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #374151;
            position: sticky;
            top: 0;
            background: #1e293b;
            z-index: 10;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #ef4444;
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            z-index: 20;
        }

        .menu-items {
            flex: 1;
            padding: 10px 0;
            /* –£–±–∏—Ä–∞–µ–º overflow —á—Ç–æ–±—ã —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞–ª —Å–∫—Ä–æ–ª–ª */
            overflow: visible;
            min-height: 0;
        }

        .menu-item {
            padding: 12px 20px;
            border-bottom: 1px solid #374151;
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .menu-item:hover {
            background: #374151;
        }

        .menu-item:active {
            background: #4b5563;
        }

        .status {
            background: #059669;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 14px;
        }

        .warning {
            background: #dc2626;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 14px;
        }

        .debug-info {
            background: #1e40af;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 12px;
            font-family: monospace;
        }

        .end-marker {
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
            padding: 20px;
            text-align: center;
            margin: 20px;
            border-radius: 8px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="main-content">
        <h1>üîß –¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é</h1>

        <div class="status">
            ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
            <br>‚Ä¢ overscroll-behavior: none
            <br>‚Ä¢ -webkit-overflow-scrolling: touch
            <br>‚Ä¢ touch-action: pan-y
            <br>‚Ä¢ scroll-behavior: smooth
        </div>

        <button class="test-btn" onclick="openSidebar()">
            üì± –û—Ç–∫—Ä—ã—Ç—å –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é
        </button>

        <h2>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</h2>
        <ol>
            <li><strong>–û—Ç–∫—Ä–æ–π –º–µ–Ω—é</strong> - –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –≤—ã—à–µ</li>
            <li><strong>–ü—Ä–æ–∫—Ä—É—Ç–∏ –≤–Ω–∏–∑</strong> –¥–æ —Å–∞–º–æ–≥–æ –∫–æ–Ω—Ü–∞ –º–µ–Ω—é</li>
            <li><strong>–ü–æ–¥–æ–∂–¥–∏ 2 —Å–µ–∫—É–Ω–¥—ã</strong> –∫–æ–≥–¥–∞ –¥–æ—Å—Ç–∏–≥–Ω–µ—à—å –∫–æ–Ω—Ü–∞</li>
            <li><strong>–ü–æ–ø—Ä–æ–±—É–π –ø—Ä–æ–∫—Ä—É—Ç–∏—Ç—å –≤–≤–µ—Ä—Ö</strong> - –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∑–∞–ª–∏–ø–∞–Ω–∏—è!</li>
            <li><strong>–ü–æ–≤—Ç–æ—Ä–∏ —Ç–µ—Å—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑</strong></li>
        </ol>

        <div class="debug-info">
            Debug Info: <span id="debugInfo">–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é</span>
        </div>

        <h3>–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</h3>
        <ul>
            <li>‚úÖ –ú–µ–Ω—é –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ—Ç—Å—è –≤–Ω–∏–∑ –ø–ª–∞–≤–Ω–æ</li>
            <li>‚úÖ –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –∫–æ–Ω—Ü–∞ –ù–ï –∑–∞–ª–∏–ø–∞–µ—Ç</li>
            <li>‚úÖ –õ–µ–≥–∫–æ –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤–≤–µ—Ä—Ö</li>
            <li>‚úÖ –ù–µ –Ω—É–∂–Ω–æ —Å–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å/—Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å —Å–µ–∫—Ü–∏–∏</li>
        </ul>
    </div>

    <!-- Overlay –∏ Sidebar -->
    <div id="overlay" class="overlay" onclick="closeSidebar()">
        <div class="sidebar" id="sidebar" onclick="event.stopPropagation()">
            <div class="sidebar-content">
                <div class="sidebar-header">
                    <button class="close-btn" onclick="closeSidebar()">‚úï</button>
                    <h3 style="color: #60a5fa; margin: 0;">TradeFrame Menu</h3>
                    <p style="font-size: 12px; color: #94a3b8; margin: 5px 0 0 0;">–¢–µ—Å—Ç –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ v1.1</p>
                </div>

                <div class="menu-items">
                    <div class="menu-item">üè¢ –¢–û–†–ì–û–í–´–ï –°–ï–¢–ò</div>
                    <div class="menu-item">üìä –û–±–∑–æ—Ä —Å–µ—Ç–µ–π</div>
                    <div class="menu-item">üí± –û–ø–µ—Ä–∞—Ü–∏–∏ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</div>
                    <div class="menu-item">üè™ –¢–û–†–ì–û–í–ê–Ø –¢–û–ß–ö–ê</div>
                    <div class="menu-item">üí∞ –¶–µ–Ω—ã</div>
                    <div class="menu-item">üõ¢Ô∏è –†–µ–∑–µ—Ä–≤—É–∞—Ä—ã</div>
                    <div class="menu-item">‚öôÔ∏è –°–∏—Å—Ç–µ–º—ã</div>
                    <div class="menu-item">üë• –ê–î–ú–ò–ù–ò–°–¢–†–ò–†–û–í–ê–ù–ò–ï</div>
                    <div class="menu-item">üåê –°–µ—Ç–∏ –∏ –¢–¢</div>
                    <div class="menu-item">üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
                    <div class="menu-item">üõ°Ô∏è –†–æ–ª–∏</div>
                    <div class="menu-item">üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</div>
                    <div class="menu-item">üìã –ü—Ä–∞–≤–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã</div>
                    <div class="menu-item">üìù –ñ—É—Ä–Ω–∞–ª –∞—É–¥–∏—Ç–∞</div>
                    <div class="menu-item">üîß –ù–ê–°–¢–†–û–ô–ö–ò</div>
                    <div class="menu-item">üîå API CTC –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                    <div class="menu-item">üóÑÔ∏è –í–Ω–µ—à–Ω—è—è –ë–î</div>
                    <div class="menu-item">üìä –†–ê–ó–ù–û–ï</div>
                    <div class="menu-item">üìà –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω</div>
                    <div class="menu-item">‚õΩ –û—Å—Ç–∞—Ç–∫–∏ —Ç–æ–ø–ª–∏–≤–∞</div>
                    <div class="menu-item">üîß –ñ—É—Ä–Ω–∞–ª –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</div>
                    <div class="menu-item">üì¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–µ—Ç–µ–π</div>
                    <div class="menu-item">üí¨ –°–æ–æ–±—â–µ–Ω–∏—è</div>
                    <div class="menu-item">üìã –û—Ç—á–µ—Ç—ã —Å–º–µ–Ω</div>
                    <div class="menu-item">üì¶ –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞</div>
                    <div class="menu-item">üèóÔ∏è –¢–∏–ø—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</div>
                    <div class="menu-item">üß© –¢–∏–ø—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</div>
                    <div class="menu-item">üìã –®–∞–±–ª–æ–Ω—ã –∫–æ–º–∞–Ω–¥ API</div>

                    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –¥–ª–∏–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ -->
                    <div class="menu-item">üìÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—É–Ω–∫—Ç 1</div>
                    <div class="menu-item">üìÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—É–Ω–∫—Ç 2</div>
                    <div class="menu-item">üìÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—É–Ω–∫—Ç 3</div>
                    <div class="menu-item">üìÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—É–Ω–∫—Ç 4</div>
                    <div class="menu-item">üìÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—É–Ω–∫—Ç 5</div>
                    <div class="menu-item">üìÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—É–Ω–∫—Ç 6</div>
                    <div class="menu-item">üìÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—É–Ω–∫—Ç 7</div>
                    <div class="menu-item">üìÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—É–Ω–∫—Ç 8</div>
                    <div class="menu-item">üìÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—É–Ω–∫—Ç 9</div>
                    <div class="menu-item">üìÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—É–Ω–∫—Ç 10</div>

                    <div class="end-marker">
                        üèÅ –ö–û–ù–ï–¶ –ú–ï–ù–Æ
                        <br><small>–î–æ—Å—Ç–∏–≥–Ω—É—Ç –Ω–∏–∂–Ω–∏–π –∫—Ä–∞–π. –ü–æ–ø—Ä–æ–±—É–π –ø—Ä–æ–∫—Ä—É—Ç–∏—Ç—å –≤–≤–µ—Ä—Ö!</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let scrollPosition = 0;
        let touchStartTime = 0;

        function updateDebug(message) {
            document.getElementById('debugInfo').textContent = message;
        }

        function openSidebar() {
            const overlay = document.getElementById('overlay');
            const sidebar = document.getElementById('sidebar');

            overlay.classList.add('open');
            sidebar.classList.add('open');

            // –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∫—Ä–æ–ª–ª body
            document.body.style.overflow = 'hidden';

            updateDebug('–ú–µ–Ω—é –æ—Ç–∫—Ä—ã—Ç–æ. –ü—Ä–æ–∫—Ä—É—Ç–∏ –¥–æ –∫–æ–Ω—Ü–∞.');

            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º —Å–∫—Ä–æ–ª–ª —Å–æ–±—ã—Ç–∏–µ
            const sidebarContent = sidebar.querySelector('.sidebar-content');
            sidebarContent.addEventListener('scroll', handleScroll);
            sidebarContent.addEventListener('touchstart', handleTouchStart);
            sidebarContent.addEventListener('touchend', handleTouchEnd);
        }

        function closeSidebar() {
            const overlay = document.getElementById('overlay');
            const sidebar = document.getElementById('sidebar');

            overlay.classList.remove('open');
            sidebar.classList.remove('open');

            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–∫—Ä–æ–ª–ª body
            document.body.style.overflow = 'auto';

            updateDebug('–ú–µ–Ω—é –∑–∞–∫—Ä—ã—Ç–æ');
        }

        function handleScroll(e) {
            const element = e.target;
            const scrollTop = element.scrollTop;
            const scrollHeight = element.scrollHeight;
            const clientHeight = element.clientHeight;
            const scrollBottom = scrollHeight - clientHeight - scrollTop;

            if (scrollBottom < 10) {
                updateDebug(`üî¥ –î–æ—Å—Ç–∏–≥–Ω—É—Ç –Ω–∏–∑! –ü–æ–ø—Ä–æ–±—É–π –ø—Ä–æ–∫—Ä—É—Ç–∏—Ç—å –≤–≤–µ—Ä—Ö. Scroll: ${scrollTop.toFixed(0)}`);
            } else if (scrollTop < 10) {
                updateDebug(`üîµ –ù–∞–≤–µ—Ä—Ö—É. Scroll: ${scrollTop.toFixed(0)}`);
            } else {
                updateDebug(`‚ö° –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ—Ç—Å—è. Scroll: ${scrollTop.toFixed(0)}, –î–æ –Ω–∏–∑–∞: ${scrollBottom.toFixed(0)}`);
            }
        }

        function handleTouchStart(e) {
            touchStartTime = Date.now();
            updateDebug(`üëÜ Touch start`);
        }

        function handleTouchEnd(e) {
            const touchDuration = Date.now() - touchStartTime;
            updateDebug(`üëÜ Touch end (${touchDuration}ms)`);
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeSidebar();
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateDebug('–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é');
    </script>
</body>
</html>