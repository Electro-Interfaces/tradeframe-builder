<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π TradeFrame</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: #1a1a1a;
      color: #fff;
    }
    .test-panel {
      background: #2d2d2d;
      padding: 20px;
      margin: 20px 0;
      border-radius: 8px;
      border: 1px solid #444;
    }
    .app-frame {
      width: 100%;
      height: 600px;
      border: 2px solid #00ff00;
      border-radius: 8px;
      background: #000;
    }
    .controls {
      display: flex;
      gap: 10px;
      margin: 10px 0;
      flex-wrap: wrap;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover { background: #0056b3; }
    .success { background: #28a745; }
    .warning { background: #ffc107; color: #000; }
    .danger { background: #dc3545; }
    .info { background: #17a2b8; }
    .status {
      padding: 8px 12px;
      border-radius: 4px;
      margin: 5px 0;
      font-size: 14px;
    }
    .log {
      background: #000;
      color: #00ff00;
      padding: 15px;
      border-radius: 4px;
      font-family: monospace;
      font-size: 12px;
      max-height: 300px;
      overflow-y: auto;
      white-space: pre-wrap;
      border: 1px solid #333;
    }
  </style>
</head>
<body>
  <h1>üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π TradeFrame v1.5.7</h1>

  <div class="test-panel">
    <h2>–°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:</h2>
    <div class="status success">‚úÖ X-Frame-Options meta tag —É–¥–∞–ª–µ–Ω –∏–∑ index.html</div>
    <div class="status success">‚úÖ CSP frame-ancestors –¥–æ–±–∞–≤–ª–µ–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</div>
    <div class="status success">‚úÖ Loading detection —É–ª—É—á—à–µ–Ω (login-form, auth-container, main, sidebar)</div>
    <div class="status success">‚úÖ PWA installer —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 3 —Å–µ–∫—É–Ω–¥—ã</div>
    <div class="status success">‚úÖ Fallback timeout —É–≤–µ–ª–∏—á–µ–Ω —Å 5 –¥–æ 8 —Å–µ–∫—É–Ω–¥</div>
  </div>

  <div class="test-panel">
    <h2>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:</h2>
    <div class="controls">
      <button onclick="openApp()" class="success">üöÄ –û—Ç–∫—Ä—ã—Ç—å TradeFrame</button>
      <button onclick="openAppNewWindow()" class="info">üîó –û—Ç–∫—Ä—ã—Ç—å –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ</button>
      <button onclick="clearStorage()" class="warning">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å Storage</button>
      <button onclick="testSequence()" class="info">‚ö° –¢–µ—Å—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</button>
    </div>
  </div>

  <div class="test-panel">
    <h2>–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:</h2>
    <ol>
      <li><strong>–ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞:</strong> –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–∫–∏ "X-Frame-Options may only be set via an HTTP header"</li>
      <li><strong>Loading –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä:</strong> –î–æ–ª–∂–µ–Ω –∏—Å—á–µ–∑–Ω—É—Ç—å –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ React –∫–æ–Ω—Ç–µ–Ω—Ç–∞</li>
      <li><strong>–¢–µ–º–Ω—ã–π —ç–∫—Ä–∞–Ω:</strong> –ù–µ –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–ª—è—Ç—å—Å—è –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</li>
      <li><strong>PWA installer:</strong> –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏</li>
      <li><strong>–ê–Ω–∏–º–∞—Ü–∏—è:</strong> –ü–ª–∞–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –±–µ–∑ —Ä—ã–≤–∫–æ–≤</li>
    </ol>
  </div>

  <div class="test-panel">
    <h2>–í—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:</h2>
    <iframe id="appFrame" class="app-frame" src="about:blank"></iframe>
  </div>

  <div class="test-panel">
    <h2>–õ–æ–≥–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</h2>
    <div id="testLog" class="log">–õ–æ–≥–∏ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å...\n</div>
    <button onclick="clearLog()">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏</button>
  </div>

  <script>
    const testLog = document.getElementById('testLog');

    function log(message, type = 'info') {
      const timestamp = new Date().toLocaleTimeString();
      const emoji = type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
      testLog.textContent += `[${timestamp}] ${emoji} ${message}\n`;
      testLog.scrollTop = testLog.scrollHeight;
    }

    function openApp() {
      log('–ó–∞–≥—Ä—É–∂–∞–µ–º TradeFrame –≤ iframe...', 'info');
      const frame = document.getElementById('appFrame');
      frame.src = 'http://localhost:3002';

      setTimeout(() => {
        log('–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã...', 'info');
      }, 2000);

      setTimeout(() => {
        log('–ü—Ä–æ–≤–µ—Ä—è–µ–º PWA installer (–¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è)...', 'info');
      }, 5000);
    }

    function openAppNewWindow() {
      log('–û—Ç–∫—Ä—ã–≤–∞–µ–º TradeFrame –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ...', 'info');
      const newWindow = window.open('http://localhost:3002', '_blank');
      log('–ù–æ–≤–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫.', 'success');
    }

    function clearStorage() {
      localStorage.clear();
      sessionStorage.clear();
      log('localStorage –∏ sessionStorage –æ—á–∏—â–µ–Ω—ã', 'success');
    }

    function testSequence() {
      log('–ù–∞—á–∏–Ω–∞–µ–º –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏...', 'info');
      log('1. –û—á–∏—â–∞–µ–º storage...', 'info');
      clearStorage();

      setTimeout(() => {
        log('2. –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ...', 'info');
        openApp();
      }, 500);

      setTimeout(() => {
        log('3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ X-Frame-Options –æ—à–∏–±–∫–∏...', 'info');
      }, 2000);

      setTimeout(() => {
        log('4. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ loading –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞...', 'info');
      }, 3000);

      setTimeout(() => {
        log('5. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—è–≤–ª–µ–Ω–∏–µ PWA installer...', 'warning');
      }, 6000);

      setTimeout(() => {
        log('‚úÖ –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∏–∑—É–∞–ª—å–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.', 'success');
      }, 8000);
    }

    function clearLog() {
      testLog.textContent = '–õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã, –Ω–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ...\n';
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    window.onload = function() {
      log('üîß –¢–µ—Å—Ç–µ—Ä TradeFrame v1.5.7 –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!', 'success');
      log('üìã –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é', 'info');
      log('üéØ –ù–∞–∂–º–∏—Ç–µ "–û—Ç–∫—Ä—ã—Ç—å TradeFrame" –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'info');
    };
  </script>
</body>
</html>