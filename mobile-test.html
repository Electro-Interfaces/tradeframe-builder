<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile Network Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: white;
            text-align: center;
        }
        .status {
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            font-size: 18px;
        }
        .success { background: #22c55e; }
        .error { background: #ef4444; }
        .info { background: #3b82f6; }
        .test-btn {
            background: #6366f1;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
        }
        .test-btn:hover { background: #4f46e5; }
    </style>
</head>
<body>
    <h1>üîß Mobile Network Access Test</h1>

    <div class="status info">
        <strong>Server Status:</strong> Testing connection...
    </div>

    <div id="network-info" class="status info">
        <strong>Your IP:</strong> Loading...
    </div>

    <div id="server-info" class="status info">
        <strong>Server:</strong> http://192.168.1.37:3000
    </div>

    <div id="test-results"></div>

    <button class="test-btn" onclick="testConnection()">üß™ Test Connection</button>
    <button class="test-btn" onclick="openApp()">üì± Open App</button>
    <button class="test-btn" onclick="clearCache()">üóëÔ∏è Clear Cache</button>

    <div id="instructions" style="margin-top: 30px; text-align: left; background: #333; padding: 20px; border-radius: 8px;">
        <h3>üìã Troubleshooting Steps:</h3>
        <ol>
            <li><strong>Check Network:</strong> –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –º–æ–±–∏–ª—å–Ω—ã–π –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä –≤ –æ–¥–Ω–æ–π WiFi —Å–µ—Ç–∏</li>
            <li><strong>Firewall:</strong> Windows –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—Ç 3000</li>
            <li><strong>Cache:</strong> –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º</li>
            <li><strong>URL:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ <code>http://192.168.1.37:3000</code></li>
            <li><strong>HTTPS:</strong> –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS, —Ç–æ–ª—å–∫–æ HTTP</li>
        </ol>

        <h3>üõ†Ô∏è Windows Firewall Fix:</h3>
        <p>–û—Ç–∫—Ä–æ–π—Ç–µ PowerShell –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:</p>
        <code style="background: #222; padding: 10px; display: block; margin: 10px 0;">
            netsh advfirewall firewall add rule name="Vite Dev Server" dir=in action=allow protocol=TCP localport=3000
        </code>
    </div>

    <script>
        // –ü–æ–ª—É—á–∞–µ–º IP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        fetch('https://api.ipify.org?format=json')
            .then(response => response.json())
            .then(data => {
                document.getElementById('network-info').innerHTML =
                    '<strong>Your IP:</strong> ' + data.ip;
            })
            .catch(error => {
                document.getElementById('network-info').innerHTML =
                    '<strong>Network:</strong> Unable to detect IP';
            });

        function testConnection() {
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.innerHTML = '<div class="status info">Testing connection...</div>';

            // –¢–µ—Å—Ç–∏—Ä—É–µ–º –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
            fetch('http://192.168.1.37:3000')
                .then(response => {
                    if (response.ok) {
                        resultsDiv.innerHTML = '<div class="status success">‚úÖ Server accessible! Connection OK</div>';
                    } else {
                        resultsDiv.innerHTML = '<div class="status error">‚ùå Server responded with error: ' + response.status + '</div>';
                    }
                })
                .catch(error => {
                    resultsDiv.innerHTML = '<div class="status error">‚ùå Connection failed: ' + error.message + '</div>';
                });
        }

        function openApp() {
            window.open('http://192.168.1.37:3000', '_blank');
        }

        function clearCache() {
            // –û—á–∏—â–∞–µ–º localStorage –∏ sessionStorage
            localStorage.clear();
            sessionStorage.clear();

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.innerHTML = '<div class="status success">üóëÔ∏è Browser cache cleared! Now try opening the app.</div>';

            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                location.reload();
            }, 2000);
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            setTimeout(testConnection, 1000);
        });

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
        const userAgent = navigator.userAgent;
        const isMobile = /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);

        document.getElementById('instructions').innerHTML +=
            '<h3>üì± Device Info:</h3>' +
            '<p><strong>Mobile:</strong> ' + (isMobile ? 'Yes' : 'No') + '</p>' +
            '<p><strong>User Agent:</strong> ' + userAgent + '</p>';
    </script>
</body>
</html>