<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–¢–µ—Å—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ API —Ä–µ–∑–µ—Ä–≤—É–∞—Ä–æ–≤</title>
</head>
<body>
    <h1>–¢–µ—Å—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ API —Ä–µ–∑–µ—Ä–≤—É–∞—Ä–æ–≤</h1>
    <div id="results"></div>

    <script type="module">
        import { tradingNetworkConfigService } from './src/services/tradingNetworkConfigService.js';
        import { tanksApiIntegrationService } from './src/services/tanksApiIntegrationService.js';

        const results = document.getElementById('results');

        async function testConfiguration() {
            console.log('üß™ –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é API –¥–ª—è —Ä–µ–∑–µ—Ä–≤—É–∞—Ä–æ–≤...');
            results.innerHTML += '<h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ API</h2>';

            try {
                // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Ç–∏
                console.log('1Ô∏è‚É£ –ü–æ–ª—É—á–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Ç–∏...');
                const config = await tradingNetworkConfigService.getConfig();
                
                console.log('üìã –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Ç–∏:', config);
                results.innerHTML += `<div><strong>–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Ç–∏:</strong></div>`;
                results.innerHTML += `<pre>${JSON.stringify(config, null, 2)}</pre>`;

                // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è —Ä–µ–∑–µ—Ä–≤—É–∞—Ä–æ–≤
                if (config.endpoints && config.endpoints.tanks) {
                    console.log('‚úÖ –≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è —Ä–µ–∑–µ—Ä–≤—É–∞—Ä–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω:', config.endpoints.tanks);
                    results.innerHTML += `<div style="color: green;">‚úÖ –≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è —Ä–µ–∑–µ—Ä–≤—É–∞—Ä–æ–≤: ${config.endpoints.tanks}</div>`;
                } else {
                    console.error('‚ùå –≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è —Ä–µ–∑–µ—Ä–≤—É–∞—Ä–æ–≤ –ù–ï –Ω–∞—Å—Ç—Ä–æ–µ–Ω!');
                    results.innerHTML += `<div style="color: red;">‚ùå –≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è —Ä–µ–∑–µ—Ä–≤—É–∞—Ä–æ–≤ –ù–ï –Ω–∞—Å—Ç—Ä–æ–µ–Ω!</div>`;
                }

                // 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–∑–æ–≤—ã–π URL
                if (config.baseUrl) {
                    console.log('‚úÖ –ë–∞–∑–æ–≤—ã–π URL –Ω–∞—Å—Ç—Ä–æ–µ–Ω:', config.baseUrl);
                    results.innerHTML += `<div style="color: green;">‚úÖ –ë–∞–∑–æ–≤—ã–π URL: ${config.baseUrl}</div>`;
                } else {
                    console.error('‚ùå –ë–∞–∑–æ–≤—ã–π URL –ù–ï –Ω–∞—Å—Ç—Ä–æ–µ–Ω!');
                    results.innerHTML += `<div style="color: red;">‚ùå –ë–∞–∑–æ–≤—ã–π URL –ù–ï –Ω–∞—Å—Ç—Ä–æ–µ–Ω!</div>`;
                }

                // 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
                if (config.enabled) {
                    console.log('‚úÖ –¢–æ—Ä–≥–æ–≤–∞—è —Å–µ—Ç—å –í–ö–õ–Æ–ß–ï–ù–ê');
                    results.innerHTML += `<div style="color: green;">‚úÖ –¢–æ—Ä–≥–æ–≤–∞—è —Å–µ—Ç—å –í–ö–õ–Æ–ß–ï–ù–ê</div>`;
                } else {
                    console.error('‚ùå –¢–æ—Ä–≥–æ–≤–∞—è —Å–µ—Ç—å –û–¢–ö–õ–Æ–ß–ï–ù–ê!');
                    results.innerHTML += `<div style="color: red;">‚ùå –¢–æ—Ä–≥–æ–≤–∞—è —Å–µ—Ç—å –û–¢–ö–õ–Æ–ß–ï–ù–ê!</div>`;
                }

                // 5. –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å API
                console.log('5Ô∏è‚É£ –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å API —Ä–µ–∑–µ—Ä–≤—É–∞—Ä–æ–≤...');
                results.innerHTML += `<h3>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</h3>`;

                const connectionTest = await tanksApiIntegrationService.testApiConnection();
                console.log('üîß –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:', connectionTest);
                
                if (connectionTest.success) {
                    results.innerHTML += `<div style="color: green;">‚úÖ ${connectionTest.message}</div>`;
                } else {
                    results.innerHTML += `<div style="color: red;">‚ùå ${connectionTest.message}</div>`;
                }

            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:', error);
                results.innerHTML += `<div style="color: red;">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
            }
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç
        testConfiguration();
    </script>
</body>
</html>