<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .result { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        pre { background-color: #f8f9fa; padding: 10px; border-radius: 4px; overflow: auto; }
        button { padding: 10px 20px; margin: 5px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        .danger { background-color: #dc3545; }
        .danger:hover { background-color: #c82333; }
    </style>
</head>
<body>
    <h1>üßπ –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h1>
    <p>–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–º–æ–∂–µ—Ç –æ—á–∏—Å—Ç–∏—Ç—å –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∞–ø–ø–∏–Ω–≥–∞ —Ä–æ–ª–µ–π.</p>

    <div>
        <button onclick="showCachedData()">üìã –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ</button>
        <button onclick="clearUserCache()" class="danger">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
        <button onclick="goToApp()">üöÄ –ü–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é</button>
    </div>

    <div id="result"></div>

    <script>
        function showCachedData() {
            const resultDiv = document.getElementById('result');

            try {
                // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –∫–ª—é—á–∏ localStorage, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
                const userKeys = Object.keys(localStorage).filter(key =>
                    key.includes('tradeframe') || key.includes('auth') || key.includes('user')
                );

                let html = '<div class="result info"><h3>üìä –¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ localStorage:</h3>';

                if (userKeys.length === 0) {
                    html += '<p>‚ùå –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
                } else {
                    userKeys.forEach(key => {
                        const value = localStorage.getItem(key);
                        let displayValue = value;

                        // –ü—ã—Ç–∞–µ–º—Å—è —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                        try {
                            const parsed = JSON.parse(value);
                            if (parsed && typeof parsed === 'object') {
                                displayValue = JSON.stringify(parsed, null, 2);
                            }
                        } catch (e) {
                            // –û—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
                        }

                        html += `<p><strong>${key}:</strong></p>`;
                        html += `<pre>${displayValue}</pre>`;
                    });
                }

                html += '</div>';
                resultDiv.innerHTML = html;
            } catch (error) {
                resultDiv.innerHTML = `<div class="result error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
            }
        }

        function clearUserCache() {
            const resultDiv = document.getElementById('result');

            try {
                const beforeKeys = Object.keys(localStorage).filter(key =>
                    key.includes('tradeframe') || key.includes('auth') || key.includes('user')
                );

                // –û—á–∏—â–∞–µ–º –≤—Å–µ –∫–ª—é—á–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
                const keysToRemove = [
                    // –ù–æ–≤—ã–µ –∫–ª—é—á–∏
                    'tradeframe_user_v2',
                    'tradeframe_token_v2',
                    // –°—Ç–∞—Ä—ã–µ –∫–ª—é—á–∏
                    'tradeframe_user',
                    'authToken',
                    'currentUser',
                    'auth_token',
                    'auth_user',
                    'auth_token_expiry',
                    'auth_login',
                    'auth_password'
                ];

                keysToRemove.forEach(key => {
                    if (localStorage.getItem(key)) {
                        localStorage.removeItem(key);
                        console.log(`–£–¥–∞–ª–µ–Ω –∫–ª—é—á: ${key}`);
                    }
                });

                const afterKeys = Object.keys(localStorage).filter(key =>
                    key.includes('tradeframe') || key.includes('auth') || key.includes('user')
                );

                resultDiv.innerHTML = `
                    <div class="result success">
                        <h3>‚úÖ –ö–µ—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—á–∏—â–µ–Ω!</h3>
                        <p><strong>–î–æ –æ—á–∏—Å—Ç–∫–∏:</strong> ${beforeKeys.length} –∫–ª—é—á–µ–π</p>
                        <p><strong>–ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏:</strong> ${afterKeys.length} –∫–ª—é—á–µ–π</p>
                        <p>üîÑ –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É –∑–∞–Ω–æ–≤–æ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∞–ø–ø–∏–Ω–≥–∞ —Ä–æ–ª–µ–π</p>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="result error">‚ùå –û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏: ${error.message}</div>`;
            }
        }

        function goToApp() {
            window.location.href = 'http://localhost:3001';
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = showCachedData;
    </script>
</body>
</html>