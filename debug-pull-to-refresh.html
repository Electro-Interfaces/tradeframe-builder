<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Debug Pull-to-Refresh</title>
    <style>
        body {
            font-family: system-ui;
            margin: 0;
            padding: 20px;
            background: #1e293b;
            color: white;
            min-height: 200vh;
        }
        
        /* –¢–æ—á–Ω–æ —Ç–µ –∂–µ CSS –ø—Ä–∞–≤–∏–ª–∞ —á—Ç–æ –∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ */
        @media (hover: none) and (pointer: coarse) {
            html, body { 
                overscroll-behavior: none !important;
                overscroll-behavior-y: none !important;
                -webkit-overscroll-behavior: none !important;
                -webkit-overscroll-behavior-y: none !important;
                touch-action: pan-x pan-y !important;
                -webkit-overflow-scrolling: auto !important;
            }
        }
        
        .status {
            position: fixed;
            top: 20px;
            left: 20px;
            right: 20px;
            background: #334155;
            padding: 15px;
            border-radius: 8px;
            z-index: 1000;
            max-height: 40vh;
            overflow-y: auto;
        }
        
        .content {
            margin-top: 200px;
            background: linear-gradient(to bottom, #334155, #1e293b);
            padding: 20px;
            min-height: 150vh;
        }
        
        .debug-info {
            background: #0f172a;
            padding: 10px;
            border-radius: 4px;
            margin: 5px 0;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="status">
        <h2>üîç Debug Pull-to-Refresh</h2>
        <p><strong>–í—Ä–µ–º—è:</strong> <span id="time"></span></p>
        
        <div class="debug-info">
            <strong>CSS –ü—Ä–æ–≤–µ—Ä–∫–∞:</strong><br>
            overscroll-behavior: <span id="overscroll"></span><br>
            -webkit-overscroll-behavior: <span id="webkit-overscroll"></span><br>
            touch-action: <span id="touch-action"></span><br>
            -webkit-overflow-scrolling: <span id="webkit-overflow"></span>
        </div>
        
        <div class="debug-info">
            <strong>Media Query:</strong><br>
            hover: none = <span id="hover-none"></span><br>
            pointer: coarse = <span id="pointer-coarse"></span><br>
            Mobile detected: <span id="mobile-detected"></span>
        </div>
        
        <div class="debug-info">
            <strong>–°–æ–±—ã—Ç–∏—è:</strong><br>
            <div id="events"></div>
        </div>
    </div>

    <div class="content">
        <h2>–¢–µ—Å—Ç–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç</h2>
        <p><strong>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</strong></p>
        <ol>
            <li>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ—Ç—è–Ω—É—Ç—å –≤–Ω–∏–∑ –æ—Ç —Å–∞–º–æ–≥–æ –≤–µ—Ä—Ö–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</li>
            <li>–ù–∞–±–ª—é–¥–∞–π—Ç–µ —Å–æ–±—ã—Ç–∏—è –≤ debug –ø–∞–Ω–µ–ª–∏</li>
            <li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å –ª–∏ CSS —Å–≤–æ–π—Å—Ç–≤–∞</li>
        </ol>
        
        <div style="height: 100px; background: #475569; margin: 20px 0; display: flex; align-items: center; justify-content: center;">
            –¢–µ—Å—Ç –∫–æ–Ω—Ç–µ–Ω—Ç 1
        </div>
        
        <div style="height: 100px; background: #64748b; margin: 20px 0; display: flex; align-items: center; justify-content: center;">
            –¢–µ—Å—Ç –∫–æ–Ω—Ç–µ–Ω—Ç 2
        </div>
        
        <div style="height: 100px; background: #475569; margin: 20px 0; display: flex; align-items: center; justify-content: center;">
            –¢–µ—Å—Ç –∫–æ–Ω—Ç–µ–Ω—Ç 3
        </div>
    </div>

    <script>
        let eventCount = 0;
        
        function updateTime() {
            document.getElementById('time').textContent = new Date().toLocaleTimeString();
        }
        
        function logEvent(message) {
            const eventsDiv = document.getElementById('events');
            const eventEl = document.createElement('div');
            eventEl.style.fontSize = '11px';
            eventEl.style.marginBottom = '2px';
            eventEl.textContent = `${++eventCount}. ${new Date().toLocaleTimeString()}: ${message}`;
            eventsDiv.appendChild(eventEl);
            if (eventsDiv.children.length > 10) {
                eventsDiv.removeChild(eventsDiv.firstChild);
            }
            eventsDiv.scrollTop = eventsDiv.scrollHeight;
        }
        
        function checkCSS() {
            const body = document.body;
            const computed = getComputedStyle(body);
            
            document.getElementById('overscroll').textContent = computed.overscrollBehavior || '–Ω–µ –∑–∞–¥–∞–Ω–æ';
            document.getElementById('webkit-overscroll').textContent = computed.getPropertyValue('-webkit-overscroll-behavior') || '–Ω–µ –∑–∞–¥–∞–Ω–æ';
            document.getElementById('touch-action').textContent = computed.touchAction || '–Ω–µ –∑–∞–¥–∞–Ω–æ';
            document.getElementById('webkit-overflow').textContent = computed.getPropertyValue('-webkit-overflow-scrolling') || '–Ω–µ –∑–∞–¥–∞–Ω–æ';
        }
        
        function checkMediaQuery() {
            const hoverNone = window.matchMedia('(hover: none)').matches;
            const pointerCoarse = window.matchMedia('(pointer: coarse)').matches;
            const isMobile = hoverNone && pointerCoarse;
            
            document.getElementById('hover-none').textContent = hoverNone ? '–¥–∞' : '–Ω–µ—Ç';
            document.getElementById('pointer-coarse').textContent = pointerCoarse ? '–¥–∞' : '–Ω–µ—Ç';
            document.getElementById('mobile-detected').textContent = isMobile ? '–¥–∞' : '–Ω–µ—Ç';
        }
        
        // Event listeners –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è touch —Å–æ–±—ã—Ç–∏–π
        document.addEventListener('touchstart', (e) => {
            logEvent(`touchstart: Y=${Math.round(e.touches[0].clientY)}, scrollY=${window.scrollY}`);
        }, { passive: true });
        
        document.addEventListener('touchmove', (e) => {
            logEvent(`touchmove: Y=${Math.round(e.touches[0].clientY)}, scrollY=${window.scrollY}`);
        }, { passive: true });
        
        document.addEventListener('touchend', (e) => {
            logEvent(`touchend: scrollY=${window.scrollY}`);
        }, { passive: true });
        
        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –ø–æ–ø—ã—Ç–∫–∏ pull-to-refresh
        let isAtTop = true;
        let startY = 0;
        
        document.addEventListener('touchstart', (e) => {
            startY = e.touches[0].clientY;
            isAtTop = window.scrollY === 0;
        });
        
        document.addEventListener('touchmove', (e) => {
            if (isAtTop && window.scrollY === 0) {
                const currentY = e.touches[0].clientY;
                const deltaY = currentY - startY;
                if (deltaY > 10) {
                    logEvent(`PULL detected: delta=${Math.round(deltaY)}px`);
                }
            }
        });
        
        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è URL (–º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ redirect)
        let currentUrl = window.location.href;
        setInterval(() => {
            if (window.location.href !== currentUrl) {
                logEvent(`URL changed: ${window.location.href}`);
                currentUrl = window.location.href;
            }
        }, 100);
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateTime();
        checkCSS();
        checkMediaQuery();
        setInterval(updateTime, 1000);
        
        // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º reload —á—Ç–æ–±—ã –æ—Ç—Å–ª–µ–¥–∏—Ç—å
        const originalReload = window.location.reload;
        window.location.reload = function() {
            logEvent('‚ö†Ô∏è window.location.reload() –≤—ã–∑–≤–∞–Ω!');
            return originalReload.apply(this, arguments);
        };
        
        logEvent('Debug —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
    </script>
</body>
</html>