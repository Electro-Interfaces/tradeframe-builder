# üìä –î–ï–¢–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢ –û –ì–û–¢–û–í–ù–û–°–¢–ò –ü–†–û–ï–ö–¢–ê –ö –ü–ï–†–ï–•–û–î–£ –ù–ê –†–ï–ê–õ–¨–ù–£–Æ –ë–ê–ó–£ –î–ê–ù–ù–´–•

## üìÖ –î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞: 01.09.2025
## üéØ –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏: **65%** ‚ö†Ô∏è

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

### ‚úÖ **–ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ:**

#### 1. **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏**
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ `apiSwitch.ts` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É mock –∏ HTTP API
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `VITE_USE_HTTP_API` –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã
- ‚úÖ –ï—Å—Ç—å debug —Ä–µ–∂–∏–º —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –≤—Å–µ—Ö API –≤—ã–∑–æ–≤–æ–≤
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞

#### 2. **HTTP –∫–ª–∏–µ–Ω—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤—ã –∫ production**
- ‚úÖ –ö–ª–∞—Å—Å `HttpApiClient` –≤ `httpClients.ts` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (Authorization, X-Trace-Id, Idempotency-Key)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É RFC 7807 (Problem Details)
- ‚úÖ –ú–µ—Ç–æ–¥—ã –¥–ª—è –≤—Å–µ—Ö CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ cookies –∏ credentials

#### 3. **–¢–∏–ø–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
- ‚úÖ –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∏–º–µ—é—Ç TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- ‚úÖ –¢–∏–ø—ã –¥–ª—è Equipment, Components, Networks, TradingPoints
- ‚úÖ –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∑–∞–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã API
- ‚úÖ Enum –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∏ –¥–µ–π—Å—Ç–≤–∏–π

#### 4. **–°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π**
- ‚úÖ 5 —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–æ–ª–µ–π —Å –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏
- ‚úÖ AuthContext —É–ø—Ä–∞–≤–ª—è–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- ‚úÖ –¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ localStorage/sessionStorage
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ UI

### ‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –≤–Ω–∏–º–∞–Ω–∏—è:**

#### 1. **üî¥ –ö–†–ò–¢–ò–ß–ù–û: –°–ª–∞–±–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**
```typescript
// –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:
params?: Record<string, any>; // –ü–æ—Ç–µ—Ä—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!
```
**–í–ª–∏—è–Ω–∏–µ:** IDE –Ω–µ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å, –æ—à–∏–±–∫–∏ –Ω–µ –ª–æ–≤—è—Ç—Å—è –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
**–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 3 —á–∞—Å–∞

#### 2. **üî¥ –ö–†–ò–¢–ò–ß–ù–û: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ç API**
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤
- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ null/undefined –∑–Ω–∞—á–µ–Ω–∏–π
**–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 2 —á–∞—Å–∞

#### 3. **üî¥ –ö–†–ò–¢–ò–ß–ù–û: –ù–µ—Ç —Ç–∞–π–º–∞—É—Ç–æ–≤ –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤**
- –ó–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç –∑–∞–≤–∏—Å–Ω—É—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ª—É—á–∏—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
**–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 1 —á–∞—Å

#### 4. **üü° –í–ê–ñ–ù–û: Mock –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã**
- –î–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –¢–æ–ª—å–∫–æ —Ç–∏–ø—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ localStorage
**–í–ª–∏—è–Ω–∏–µ:** –ù–µ—É–¥–æ–±—Å—Ç–≤–æ –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

#### 5. **üü° –í–ê–ñ–ù–û: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
- –ö–∞–∂–¥—ã–π –ø–µ—Ä–µ—Ö–æ–¥ = –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∫ API
- –õ–∏—à–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –ú–µ–¥–ª–µ–Ω–Ω—ã–π UI
**–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 4 —á–∞—Å–∞

---

## üìÅ –ê–ù–ê–õ–ò–ó –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø –î–ê–ù–ù–´–•

### üìç **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è Mock –¥–∞–Ω–Ω—ã–µ:**

| –°–µ—Ä–≤–∏—Å | –§–∞–π–ª | –ö–æ–ª-–≤–æ mock –∑–∞–ø–∏—Å–µ–π | –°—Ç–∞—Ç—É—Å |
|--------|------|-------------------|---------|
| Equipment | `services/equipment.ts` | 6 –µ–¥–∏–Ω–∏—Ü | ‚ö†Ô∏è –ù–µ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã |
| Components | `services/components.ts` | 3 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ | ‚ö†Ô∏è –ù–µ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã |
| Nomenclature | `services/nomenclatureService.ts` | 7 –ø–æ–∑–∏—Ü–∏–π | ‚ö†Ô∏è –ù–µ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã |
| Connections | `services/connections.ts` | 2 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è | ‚ö†Ô∏è –ù–µ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã |
| Component Templates | `mock/componentTemplatesStore.ts` | 10 —à–∞–±–ª–æ–Ω–æ–≤ | ‚úÖ –°—Ç–∞—Ç–∏—á–Ω—ã |
| Networks | `mock/networksStore.ts` | 3 —Å–µ—Ç–∏ | ‚úÖ –°—Ç–∞—Ç–∏—á–Ω—ã |
| Trading Points | `mock/tradingPointsStore.ts` | 9 —Ç–æ—á–µ–∫ | ‚úÖ –°—Ç–∞—Ç–∏—á–Ω—ã |

### üíæ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ localStorage:**

| –ö–ª—é—á | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|------|-----------|------------|
| `currentUser` | –î–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ |
| `auth_token` | –¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ |
| `tc:selectedNetwork` | –í—ã–±—Ä–∞–Ω–Ω–∞—è —Å–µ—Ç—å –ê–ó–° | üü° –í–∞–∂–Ω–æ |
| `tc:selectedTradingPoint` | –í—ã–±—Ä–∞–Ω–Ω–∞—è —Ç–æ—á–∫–∞ | üü° –í–∞–∂–Ω–æ |
| `equipmentTypes` | –¢–∏–ø—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è | üü¢ –ù–µ–∫—Ä–∏—Ç–∏—á–Ω–æ |

---

## üîÑ –ü–õ–ê–ù –ú–ò–ì–†–ê–¶–ò–ò –ù–ê –†–ï–ê–õ–¨–ù–£–Æ –ë–î

### **–§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (8 —á–∞—Å–æ–≤)**

#### ‚úÖ –ó–∞–¥–∞—á–∞ 1.1: –£—Å–∏–ª–∏—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é (3 —á–∞—Å–∞)
```typescript
// –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª src/types/params.ts
export interface TankParams {
  capacityLiters: number;
  minLevelPercent: number;
  fuelType: FuelType;
}

export interface TerminalParams {
  posId: string;
  printerEnabled: boolean;
}

export type EquipmentParams = TankParams | TerminalParams;
```

#### ‚úÖ –ó–∞–¥–∞—á–∞ 1.2: –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é Zod (2 —á–∞—Å–∞)
```bash
npm install zod
```
```typescript
// src/schemas/equipment.ts
import { z } from 'zod';

export const EquipmentSchema = z.object({
  id: z.string().uuid(),
  display_name: z.string().min(1).max(255),
  status: z.enum(['online', 'offline', 'error']),
  // ...
});

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ API:
const data = EquipmentSchema.parse(response);
```

#### ‚úÖ –ó–∞–¥–∞—á–∞ 1.3: –î–æ–±–∞–≤–∏—Ç—å —Ç–∞–π–º–∞—É—Ç—ã (1 —á–∞—Å)
```typescript
// httpClients.ts
const controller = new AbortController();
setTimeout(() => controller.abort(), 30000);

await fetch(url, {
  signal: controller.signal,
  // ...
});
```

#### ‚úÖ –ó–∞–¥–∞—á–∞ 1.4: –ó–∞—â–∏—Ç–∞ –æ—Ç XSS (1 —á–∞—Å)
```bash
npm install dompurify
```

#### ‚úÖ –ó–∞–¥–∞—á–∞ 1.5: –û–±—Ä–∞–±–æ—Ç–∫–∞ edge cases (1 —á–∞—Å)
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null/undefined
- –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω—ã—Ö –∫–ª–∏–∫–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫

### **–§–∞–∑–∞ 2: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É API (4 —á–∞—Å–∞)**

#### ‚úÖ –ó–∞–¥–∞—á–∞ 2.1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# .env.production
VITE_USE_HTTP_API=true
VITE_API_URL=https://api.tradeframe.com/v1
VITE_AUTH_ENABLED=true
```

#### ‚úÖ –ó–∞–¥–∞—á–∞ 2.2: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤
```typescript
// services/equipment.ts
export const currentEquipmentAPI = httpEquipmentAPI; // –ë—ã–ª–æ: mockEquipmentAPI
```

#### ‚úÖ –ó–∞–¥–∞—á–∞ 2.3: –£–¥–∞–ª–µ–Ω–∏–µ –¥–µ–º–æ-–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
- –£–±—Ä–∞—Ç—å "‚ö†Ô∏è –î–ï–ú–û –†–ï–ñ–ò–ú" –∏–∑ UI
- –£–¥–∞–ª–∏—Ç—å –∑–∞–≥–ª—É—à–∫–∏ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

#### ‚úÖ –ó–∞–¥–∞—á–∞ 2.4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### **–§–∞–∑–∞ 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (6 —á–∞—Å–æ–≤)**

#### ‚úÖ –ó–∞–¥–∞—á–∞ 3.1: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ React Query (4 —á–∞—Å–∞)
```typescript
const { data, isLoading, error } = useQuery({
  queryKey: ['equipment', tradingPointId],
  queryFn: () => equipmentAPI.list({ trading_point_id: tradingPointId }),
  staleTime: 5 * 60 * 1000,
});
```

#### ‚úÖ –ó–∞–¥–∞—á–∞ 3.2: –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (2 —á–∞—Å–∞)
```typescript
const mutation = useMutation({
  mutationFn: updateEquipment,
  onMutate: async (newData) => {
    // –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å UI
    queryClient.setQueryData(['equipment'], newData);
  },
  onError: () => {
    // –û—Ç–∫–∞—Ç–∏—Ç—å –ø—Ä–∏ –æ—à–∏–±–∫–µ
    queryClient.invalidateQueries(['equipment']);
  },
});
```

---

## üóÑÔ∏è –¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö –ë–ê–ó–ï –î–ê–ù–ù–´–•

### **–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã:**

```sql
-- 1. –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
CREATE TABLE equipment (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  trading_point_id UUID NOT NULL REFERENCES trading_points(id),
  template_id UUID NOT NULL REFERENCES equipment_templates(id),
  display_name VARCHAR(255) NOT NULL,
  serial_number VARCHAR(100),
  status equipment_status NOT NULL DEFAULT 'offline',
  params JSONB DEFAULT '{}',
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),
  deleted_at TIMESTAMPTZ,
  
  INDEX idx_equipment_trading_point (trading_point_id),
  INDEX idx_equipment_status (status),
  INDEX idx_equipment_deleted (deleted_at)
);

-- 2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
CREATE TABLE components (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  equipment_id UUID NOT NULL REFERENCES equipment(id) ON DELETE CASCADE,
  template_id UUID NOT NULL REFERENCES component_templates(id),
  display_name VARCHAR(255) NOT NULL,
  serial_number VARCHAR(100),
  params JSONB DEFAULT '{}',
  status component_status NOT NULL DEFAULT 'online',
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),
  
  INDEX idx_components_equipment (equipment_id),
  INDEX idx_components_status (status)
);

-- 3. –®–∞–±–ª–æ–Ω—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
CREATE TABLE equipment_templates (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(255) NOT NULL,
  technical_code VARCHAR(100) UNIQUE NOT NULL,
  system_type VARCHAR(100) NOT NULL,
  default_params JSONB DEFAULT '{}',
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 4. –®–∞–±–ª–æ–Ω—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
CREATE TABLE component_templates (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  code VARCHAR(50) UNIQUE NOT NULL,
  name VARCHAR(255) NOT NULL,
  params_schema JSONB NOT NULL,
  defaults JSONB DEFAULT '{}',
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 5. –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
CREATE TABLE equipment_component_compatibility (
  equipment_template_id UUID REFERENCES equipment_templates(id),
  component_template_id UUID REFERENCES component_templates(id),
  PRIMARY KEY (equipment_template_id, component_template_id)
);

-- 6. –ê—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
CREATE TABLE audit_log (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  entity_type VARCHAR(50) NOT NULL,
  entity_id UUID NOT NULL,
  action VARCHAR(50) NOT NULL,
  user_id UUID NOT NULL,
  changes JSONB,
  ip_address INET,
  user_agent TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  
  INDEX idx_audit_entity (entity_type, entity_id),
  INDEX idx_audit_user (user_id),
  INDEX idx_audit_created (created_at DESC)
);
```

### **–ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ü–æ trading_point_id –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ –ü–æ status –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –ü–æ deleted_at –¥–ª—è soft delete
- ‚úÖ –°–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

## üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### **–¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**

| –ü—Ä–æ–±–ª–µ–º–∞ | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –†–µ—à–µ–Ω–∏–µ | –í—Ä–µ–º—è |
|----------|------------|---------|-------|
| XSS —É—è–∑–≤–∏–º–æ—Å—Ç–∏ | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ | DOMPurify | 1 —á–∞—Å |
| –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CSRF –∑–∞—â–∏—Ç—ã | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ | CSRF —Ç–æ–∫–µ–Ω—ã | 2 —á–∞—Å–∞ |
| –¢–æ–∫–µ–Ω—ã –≤ localStorage | üü° –í–∞–∂–Ω–æ | HttpOnly cookies | 3 —á–∞—Å–∞ |
| –ù–µ—Ç rate limiting | üü° –í–∞–∂–Ω–æ | API Gateway | –ù–∞ backend |
| SQL –∏–Ω—ä–µ–∫—Ü–∏–∏ | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã | - |

---

## üìä –ú–ï–¢–†–ò–ö–ò –ì–û–¢–û–í–ù–û–°–¢–ò

### **–ü–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º:**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å | –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å |
|-----------|-----------|-------------------|
| Frontend —Ç–∏–ø–∏–∑–∞—Ü–∏—è | 70% | –£—Å–∏–ª–∏—Ç—å —Ç–∏–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ |
| API –∫–ª–∏–µ–Ω—Ç—ã | 90% | –î–æ–±–∞–≤–∏—Ç—å —Ç–∞–π–º–∞—É—Ç—ã |
| –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö | 20% | –í–Ω–µ–¥—Ä–∏—Ç—å Zod —Å—Ö–µ–º—ã |
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ | 80% | –û–±—Ä–∞–±–æ—Ç–∞—Ç—å edge cases |
| –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è | 85% | –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ HttpOnly cookies |
| UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã | 95% | –ì–æ—Ç–æ–≤—ã |
| –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ | 0% | –í–Ω–µ–¥—Ä–∏—Ç—å React Query |
| –¢–µ—Å—Ç—ã | 5% | –ù–∞–ø–∏—Å–∞—Ç—å unit –∏ e2e —Ç–µ—Å—Ç—ã |

### **–û–±—â–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: 65%**

---

## ‚è∞ –í–†–ï–ú–ï–ù–ù–´–ï –û–¶–ï–ù–ö–ò

### **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è production):**
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: **8 —á–∞—Å–æ–≤**
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API: **4 —á–∞—Å–∞**
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: **4 —á–∞—Å–∞**
- **–ò–¢–û–ì–û: 16 —á–∞—Å–æ–≤ (2 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è)**

### **–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω: **16 —á–∞—Å–æ–≤**
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–∫—ç—à, –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è): **6 —á–∞—Å–æ–≤**
- –£–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: **4 —á–∞—Å–∞**
- –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã: **8 —á–∞—Å–æ–≤**
- **–ò–¢–û–ì–û: 34 —á–∞—Å–∞ (4-5 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π)**

### **–ò–¥–µ–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω (best practices):**
- –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω: **34 —á–∞—Å–∞**
- –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ: **16 —á–∞—Å–æ–≤**
- i18n –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è: **8 —á–∞—Å–æ–≤**
- PWA —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: **8 —á–∞—Å–æ–≤**
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: **4 —á–∞—Å–∞**
- **–ò–¢–û–ì–û: 70 —á–∞—Å–æ–≤ (8-9 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π)**

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ë–ª–æ–∫–µ—Ä—ã –¥–ª—è production):**
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö
3. ‚úÖ –í–Ω–µ–¥—Ä–∏—Ç—å —Ç–∞–π–º–∞—É—Ç—ã –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
4. ‚úÖ –ó–∞—â–∏—Ç–∏—Ç—å –æ—Ç XSS –∞—Ç–∞–∫

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–ö–∞—á–µ—Å—Ç–≤–æ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å):**
1. ‚úÖ –í–Ω–µ–¥—Ä–∏—Ç—å React Query –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
3. ‚úÖ –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏–π –∑–∞–≥—Ä—É–∑–∫–∏

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è):**
1. ‚úÖ –ù–∞–ø–∏—Å–∞—Ç—å unit –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å i18n –ø–æ–¥–¥–µ—Ä–∂–∫—É
3. ‚úÖ –í–Ω–µ–¥—Ä–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤

---

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç —Ö–æ—Ä–æ—à—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é –æ—Å–Ω–æ–≤—É –∏ –≥–æ—Ç–æ–≤ –∫ –ø–µ—Ä–µ—Ö–æ–¥—É –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é –ë–î –Ω–∞ 65%.**

### ‚úÖ **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- –û—Ç–ª–∏—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º —Å–ª–æ–µ–≤
- –ì–æ—Ç–æ–≤—ã–µ HTTP –∫–ª–∏–µ–Ω—Ç—ã
- –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π
- –ü—Ä–æ–¥—É–º–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤

### ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏:**
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

### üöÄ **–ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π:**
1. **–°–µ–≥–æ–¥–Ω—è-–∑–∞–≤—Ç—Ä–∞:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (8 —á–∞—Å–æ–≤)
2. **–ß–µ—Ä–µ–∑ 2-3 –¥–Ω—è:** –ü–æ–¥–∫–ª—é—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω–æ–µ API (4 —á–∞—Å–∞)
3. **–ß–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é:** –í–Ω–µ–¥—Ä–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (6 —á–∞—Å–æ–≤)
4. **–í —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞:** –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

**–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∞ (16 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã) –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤ –∫ production –Ω–∞ 90%.**