<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Network Overview Page</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #1a1a1a; color: white; }
        .container { max-width: 800px; margin: 0 auto; }
        .test-section { background: #2a2a2a; border: 1px solid #444; border-radius: 8px; padding: 15px; margin: 10px 0; }
        .status { padding: 8px; border-radius: 4px; margin: 10px 0; }
        .success { background: #16a34a; }
        .error { background: #dc2626; }
        .warning { background: #f59e0b; }
        button { background: #3b82f6; color: white; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #2563eb; }
        pre { background: #111; padding: 10px; border-radius: 4px; overflow-x: auto; }
        .loading { color: #f59e0b; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Debug: Network Overview Page</h1>
        
        <div class="test-section">
            <h2>–ë–∞–∑–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</h2>
            <button onclick="testPageLoad()">–¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</button>
            <div id="page-load-status"></div>
        </div>

        <div class="test-section">
            <h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫ –∫–æ–Ω—Å–æ–ª–∏</h2>
            <button onclick="checkConsoleErrors()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏ –∫–æ–Ω—Å–æ–ª–∏</button>
            <div id="console-errors"></div>
        </div>

        <div class="test-section">
            <h2>–°–æ—Å—Ç–æ—è–Ω–∏–µ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</h2>
            <button onclick="checkReactComponents()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</button>
            <div id="react-status"></div>
        </div>

        <div class="test-section">
            <h2>–ü—Ä—è–º–æ–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É</h2>
            <button onclick="goToNetworkOverview()">–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É</button>
            <div id="navigation-status"></div>
        </div>

        <div class="test-section">
            <h2>–î–µ—Ç–∞–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ—à–∏–±–∫–∏</h2>
            <div id="error-details"></div>
        </div>
    </div>

    <script>
        let errorLog = [];
        
        // –ü–µ—Ä–µ—Ö–≤–∞—Ç –æ—à–∏–±–æ–∫ JavaScript
        window.onerror = function(msg, url, line, col, error) {
            const errorInfo = {
                message: msg,
                source: url,
                line: line,
                column: col,
                error: error ? error.stack : null,
                timestamp: new Date().toISOString()
            };
            errorLog.push(errorInfo);
            console.error('üí• JavaScript Error captured:', errorInfo);
        };

        // –ü–µ—Ä–µ—Ö–≤–∞—Ç –æ—à–∏–±–æ–∫ Promise
        window.addEventListener('unhandledrejection', function(event) {
            const errorInfo = {
                message: 'Unhandled Promise Rejection',
                reason: event.reason,
                timestamp: new Date().toISOString()
            };
            errorLog.push(errorInfo);
            console.error('üí• Promise Rejection captured:', errorInfo);
        });

        function testPageLoad() {
            const statusDiv = document.getElementById('page-load-status');
            statusDiv.innerHTML = '<div class="loading">‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã...</div>';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
            fetch('http://localhost:3006')
                .then(response => {
                    if (response.ok) {
                        statusDiv.innerHTML = '<div class="status success">‚úÖ –°–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3006</div>';
                        return testSpecificPage();
                    } else {
                        throw new Error(`Server responded with ${response.status}`);
                    }
                })
                .catch(error => {
                    statusDiv.innerHTML = `<div class="status error">‚ùå –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É: ${error.message}</div>`;
                });
        }

        function testSpecificPage() {
            const statusDiv = document.getElementById('page-load-status');
            
            // –¢–µ—Å—Ç–∏—Ä—É–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            fetch('http://localhost:3006/network/overview')
                .then(response => {
                    if (response.ok) {
                        statusDiv.innerHTML += '<div class="status success">‚úÖ –ú–∞—Ä—à—Ä—É—Ç /network/overview –¥–æ—Å—Ç—É–ø–µ–Ω</div>';
                    } else {
                        throw new Error(`Page responded with ${response.status}`);
                    }
                })
                .catch(error => {
                    statusDiv.innerHTML += `<div class="status error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: ${error.message}</div>`;
                });
        }

        function checkConsoleErrors() {
            const errorsDiv = document.getElementById('console-errors');
            
            if (errorLog.length === 0) {
                errorsDiv.innerHTML = '<div class="status success">‚úÖ –û—à–∏–±–æ–∫ JavaScript –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ</div>';
            } else {
                let errorHtml = `<div class="status error">‚ùå –ù–∞–π–¥–µ–Ω–æ ${errorLog.length} –æ—à–∏–±–æ–∫:</div>`;
                errorLog.forEach((error, index) => {
                    errorHtml += `
                        <div class="test-section">
                            <h4>–û—à–∏–±–∫–∞ ${index + 1}:</h4>
                            <pre>${JSON.stringify(error, null, 2)}</pre>
                        </div>
                    `;
                });
                errorsDiv.innerHTML = errorHtml;
            }
        }

        function checkReactComponents() {
            const statusDiv = document.getElementById('react-status');
            statusDiv.innerHTML = '<div class="loading">‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è React...</div>';
            
            // –ü–æ–ø—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ React –≤ DOM
            setTimeout(() => {
                const reactRoot = document.querySelector('[data-reactroot]') || 
                                document.querySelector('#root') ||
                                document.querySelector('#app');
                
                if (reactRoot) {
                    const hasReactContent = reactRoot.innerHTML.length > 100;
                    if (hasReactContent) {
                        statusDiv.innerHTML = '<div class="status success">‚úÖ React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç—Ä–µ–Ω–¥–µ—Ä–∏–ª–æ—Å—å</div>';
                    } else {
                        statusDiv.innerHTML = '<div class="status warning">‚ö†Ô∏è React –∫–æ—Ä–Ω–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω, –Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—É—Å—Ç–æ–µ</div>';
                    }
                } else {
                    statusDiv.innerHTML = '<div class="status error">‚ùå React –∫–æ—Ä–Ω–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω</div>';
                }
            }, 1000);
        }

        function goToNetworkOverview() {
            const statusDiv = document.getElementById('navigation-status');
            statusDiv.innerHTML = '<div class="loading">‚è≥ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ...</div>';
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
            const newWindow = window.open('http://localhost:3006/network/overview', '_blank');
            
            setTimeout(() => {
                if (newWindow && !newWindow.closed) {
                    statusDiv.innerHTML = '<div class="status success">‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–∫—Ä—ã—Ç–∞ –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ</div>';
                } else {
                    statusDiv.innerHTML = '<div class="status error">‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</div>';
                }
            }, 2000);
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', function() {
            setTimeout(() => {
                const errorDetails = document.getElementById('error-details');
                if (errorLog.length > 0) {
                    errorDetails.innerHTML = `
                        <div class="status error">
                            ‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—à–∏–±–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
                            <pre>${JSON.stringify(errorLog, null, 2)}</pre>
                        </div>
                    `;
                } else {
                    errorDetails.innerHTML = '<div class="status success">‚úÖ –û—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ</div>';
                }
            }, 3000);
        });

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
        setInterval(() => {
            fetch('http://localhost:3006/api/health')
                .catch(() => {
                    console.warn('‚ö†Ô∏è API —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
                });
        }, 5000);
    </script>
</body>
</html>