<!DOCTYPE html>
<html>
<head>
    <title>üîß –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .log { margin: 10px 0; padding: 10px; background: #f5f5f5; border-radius: 4px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
        .info { background: #d1ecf1; border: 1px solid #bee5eb; color: #0c5460; }
        button { padding: 10px 20px; margin: 10px 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üîß –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏</h1>
    
    <div>
        <button onclick="testSync()">–¢–µ—Å—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å –ª–æ–≥–∞–º–∏</button>
        <button onclick="clearLogs()">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏</button>
    </div>
    
    <div id="logs"></div>

    <script>
        function log(message, type = 'info') {
            const logsDiv = document.getElementById('logs');
            const logEntry = document.createElement('div');
            logEntry.className = `log ${type}`;
            logEntry.innerHTML = `${new Date().toLocaleTimeString()} - ${message}`;
            logsDiv.appendChild(logEntry);
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        function clearLogs() {
            document.getElementById('logs').innerHTML = '';
            console.clear();
        }

        async function testSync() {
            log('üöÄ –ù–∞—á–∞–ª–æ —Ç–µ—Å—Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏', 'info');
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–∞ –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
                if (typeof window.tradingTransactionsSyncService !== 'undefined') {
                    log('‚úÖ tradingTransactionsSyncService –Ω–∞–π–¥–µ–Ω –≤ window', 'success');
                    
                    const syncOptions = {
                        systemId: 15,
                        stationNumber: 4,
                        startDate: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(),
                        endDate: new Date().toISOString()
                    };
                    
                    log('üîß –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏: ' + JSON.stringify(syncOptions, null, 2), 'info');
                    
                    // –í—ã–∑—ã–≤–∞–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
                    const result = await window.tradingTransactionsSyncService.syncTransactions(syncOptions);
                    
                    log('‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏: ' + JSON.stringify(result, null, 2), 'success');
                    
                } else {
                    log('‚ùå tradingTransactionsSyncService –ù–ï –Ω–∞–π–¥–µ–Ω –≤ window', 'error');
                    log('üîç –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ window:', 'info');
                    Object.keys(window).filter(key => key.includes('trading') || key.includes('sync')).forEach(key => {
                        log(`   - ${key}`, 'info');
                    });
                }
                
            } catch (error) {
                log('‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞: ' + error.message, 'error');
                console.error('–ü–æ–ª–Ω–∞—è –æ—à–∏–±–∫–∞:', error);
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = () => {
            log('üåê –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞', 'success');
            log('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤...', 'info');
            
            // –ñ–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
            setTimeout(() => {
                if (typeof window.tradingTransactionsSyncService !== 'undefined') {
                    log('‚úÖ tradingTransactionsSyncService –¥–æ—Å—Ç—É–ø–µ–Ω', 'success');
                } else {
                    log('‚ö†Ô∏è tradingTransactionsSyncService –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                }
            }, 2000);
        };
    </script>
</body>
</html>