<!DOCTYPE html>
<html>
<head>
    <title>Instructions Final Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test { margin: 10px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background: #e8f5e8; border-color: #4caf50; }
        .error { background: #fde8e8; border-color: #f44336; }
        .info { background: #e3f2fd; border-color: #2196f3; }
        .warning { background: #fff3e0; border-color: #ff9800; }
        .fixed { background: #f1f8e9; border-color: #8bc34a; border-left: 6px solid #4caf50; }
        .button { 
            background: #4caf50; 
            color: white; 
            border: none; 
            padding: 15px 30px; 
            margin: 10px 5px; 
            border-radius: 5px; 
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }
        .button:hover { background: #45a049; }
        .button.secondary { background: #2196f3; }
        .button.secondary:hover { background: #1976d2; }
    </style>
</head>
<body>
    <h1>‚úÖ Instructions Database Integration - Final Test</h1>
    
    <div class="test fixed">
        <h3>üéâ –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!</h3>
        <p><strong>–ù–∞–π–¥–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:</strong> –ö–æ–Ω—Ñ–ª–∏–∫—Ç URL –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏</p>
        <p><strong>–ü—Ä–∏—á–∏–Ω–∞:</strong> <code>instructionsServiceDatabase.ts</code> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Supabase URL</p>
        <p><strong>–†–µ—à–µ–Ω–∏–µ:</strong> –û–±–Ω–æ–≤–ª–µ–Ω URL –≤ <code>supabaseServiceClient.ts</code></p>
        <ul>
            <li>‚ùå –°—Ç–∞—Ä—ã–π URL: <code>tohtryzyffcebtyvkxwh.supabase.co</code> (404 –æ—à–∏–±–∫–∏)</li>
            <li>‚úÖ –ù–æ–≤—ã–π URL: <code>ssvazdgnmatbdynkhkqo.supabase.co</code> (—Ä–∞–±–æ—á–∏–π)</li>
        </ul>
    </div>
    
    <div class="test success">
        <h3>üìä –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</h3>
        <p>‚úÖ <strong>–°–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:</strong> http://localhost:3005</p>
        <p>‚úÖ <strong>Supabase URL:</strong> –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç</p>
        <p>‚úÖ <strong>Database Mode:</strong> –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∞–∫—Ç–∏–≤–µ–Ω</p>
        <p>‚úÖ <strong>–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</strong> –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ localStorage</p>
    </div>
    
    <div class="test">
        <h3>üß™ –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞</h3>
        <button class="button" onclick="openInstructions()">üìÑ –û–¢–ö–†–´–¢–¨ –ò–ù–°–¢–†–£–ö–¶–ò–ò</button>
        <button class="button secondary" onclick="checkConsole()">üñ•Ô∏è –ü–†–û–í–ï–†–ò–¢–¨ –ö–û–ù–°–û–õ–¨</button>
        <button class="button secondary" onclick="testMigration()">üîÑ –¢–ï–°–¢ –ú–ò–ì–†–ê–¶–ò–ò</button>
    </div>

    <div class="test info">
        <h3>üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <p><strong>–¢–µ–ø–µ—Ä—å –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:</strong></p>
        <ol>
            <li>‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫</li>
            <li>‚úÖ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∑–µ–ª–µ–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</li>
            <li>‚úÖ InstructionsService –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ë–î</li>
            <li>‚úÖ –î–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑ localStorage –≤ Supabase</li>
            <li>‚úÖ –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ</li>
        </ol>
    </div>

    <div class="test warning">
        <h3>üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h3>
        <ol>
            <li><strong>–û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π</strong> –ø–æ –∫–Ω–æ–ø–∫–µ –≤—ã—à–µ</li>
            <li><strong>–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –≤ LocalStorage —Ä–µ–∂–∏–º</strong> - —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ</li>
            <li><strong>–í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é</strong> –Ω–∞–∂–∞–≤ –∫–Ω–æ–ø–∫—É "–ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ Supabase"</li>
            <li><strong>–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –≤ Database —Ä–µ–∂–∏–º</strong> - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è!</li>
            <li><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞</strong> - –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 404 –æ—à–∏–±–æ–∫</li>
        </ol>
    </div>

    <div id="results"></div>

    <script>
        function addResult(title, type, data) {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `test ${type}`;
            div.innerHTML = `
                <h3>${title}</h3>
                <pre>${typeof data === 'string' ? data : JSON.stringify(data, null, 2)}</pre>
            `;
            results.appendChild(div);
        }

        window.openInstructions = function() {
            window.open('http://localhost:3005/admin/instructions', '_blank');
            addResult('üìÑ Instructions Page Opened', 'success', 
                '–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –æ—Ç–∫—Ä—ã—Ç–∞ –Ω–∞ –ø–æ—Ä—Ç—É 3005 —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º Supabase URL.\n' +
                '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ:\n' +
                '1. –ù–µ—Ç –æ—à–∏–±–æ–∫ 404 –≤ –∫–æ–Ω—Å–æ–ª–∏\n' +
                '2. –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∑–µ–ª–µ–Ω—ã–µ\n' +
                '3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏'
            );
        };

        window.checkConsole = function() {
            const consoleGuide = \`
üñ•Ô∏è –ü–†–û–í–ï–†–ö–ê –ö–û–ù–°–û–õ–ò –ë–†–ê–£–ó–ï–†–ê

–û–®–ò–ë–ö–ò –ö–û–¢–û–†–´–ï –î–û–õ–ñ–ù–´ –ò–°–ß–ï–ó–ù–£–¢–¨:
‚ùå "Failed to load resource: the server responded with a status of 404"
‚ùå "tohtryzyffcebtyvkxwh.supabase.co/rest/v1/page_help" –æ—à–∏–±–∫–∏

–•–û–†–û–®–ò–ï –°–ò–ì–ù–ê–õ–´ –ö–û–¢–û–†–´–ï –î–û–õ–ñ–ù–´ –ü–û–Ø–í–ò–¢–¨–°–Ø:
‚úÖ "üîß Supabase Service Client Configuration"
‚úÖ "URL: https://ssvazdgnmatbdynkhkqo.supabase.co"  
‚úÖ –£—Å–ø–µ—à–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ 404 –æ—à–∏–±–æ–∫
‚úÖ "‚úÖ Topics loaded" –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –≤ Database —Ä–µ–∂–∏–º

–ö–ê–ö –ü–†–û–í–ï–†–ò–¢–¨:
1. F12 -> Console
2. –û—á–∏—Å—Ç–∏—Ç–µ –∫–æ–Ω—Å–æ–ª—å (Clear console)
3. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫ 404
\`;

            addResult('üñ•Ô∏è Console Check Instructions', 'info', consoleGuide);
        };

        window.testMigration = function() {
            const migrationTest = \`
üîÑ –¢–ï–°–¢ –ú–ò–ì–†–ê–¶–ò–ò –î–ê–ù–ù–´–•

–°–¶–ï–ù–ê–†–ò–ô –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:
1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –≤ LocalStorage —Ä–µ–∂–∏–º
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –µ—Å—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (~22 —Ç–µ–º—ã)
3. –ù–∞–∂–º–∏—Ç–µ "–ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ Supabase (X —Ç–µ–º)"
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏
5. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –≤ Database —Ä–µ–∂–∏–º
6. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –≤ —Å–ø–∏—Å–∫–µ!

–ö–û–ú–ê–ù–î–ê –î–õ–Ø –ö–û–ù–°–û–õ–ò (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±):
const newService = await import('/src/services/instructionsServiceDatabase.ts');
const oldService = await import('/src/services/instructionsService.ts');

const topics = await oldService.instructionsService.getTopics();
const allVersions = [];
for (const topic of topics) {
  const versions = await oldService.instructionsService.getVersions(topic.id);
  allVersions.push(...versions);
}

await newService.InstructionsService.migrateMockData(topics, allVersions);
console.log('Migration completed!');
\`;

            addResult('üîÑ Migration Test Guide', 'warning', migrationTest);
        };

        // Show current status
        setTimeout(() => {
            addResult('üöÄ System Status', 'success', {
                dev_server: 'http://localhost:3005',
                supabase_url: 'https://ssvazdgnmatbdynkhkqo.supabase.co (FIXED)',
                database_mode: 'Default enabled',
                indicators: 'Configured in localStorage',
                status: 'Ready for testing!'
            });
        }, 1000);
    </script>
</body>
</html>