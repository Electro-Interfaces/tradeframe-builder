<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ –¢–µ—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ HTTP –∫–ª–∏–µ–Ω—Ç–∞</title>
    <style>
        body { 
            font-family: monospace; 
            background: #1e1e1e; 
            color: #fff; 
            padding: 20px; 
            line-height: 1.4;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
        .info { color: #17a2b8; }
        .code { 
            background: #0d1117; 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 5px; 
            border-left: 4px solid #444;
            overflow-x: auto;
        }
        .highlight { 
            background: #2d4a22; 
            padding: 10px; 
            border-left: 4px solid #28a745;
            margin: 10px 0;
        }
        .section {
            border: 1px solid #444;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            background: #2d2d2d;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        button.success { background: #28a745; }
        button.warning { background: #ffc107; color: #000; }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .test-card {
            border: 1px solid #555;
            border-radius: 8px;
            padding: 15px;
            background: #333;
        }
        .status-ready { border-left: 4px solid #28a745; }
        .status-pending { border-left: 4px solid #ffc107; }
        .status-error { border-left: 4px solid #dc3545; }
    </style>
</head>
<body>
    <h1>üöÄ –¢–ï–°–¢ –ì–û–¢–û–í–ù–û–°–¢–ò –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–û–ì–û HTTP –ö–õ–ò–ï–ù–¢–ê</h1>
    <p>–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Ä–∞–±–æ—Ç–µ —Å —Ä–∞–∑–¥–µ–ª–∞–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</p>
    
    <div class="section">
        <h3>üéØ –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã</h3>
        <button onclick="testBasicFunctionality()">‚ö° –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å</button>
        <button onclick="testDatabaseIntegration()">üóÑÔ∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ë–î</button>
        <button onclick="testExternalApiIntegration()">üåê –í–Ω–µ—à–Ω–∏–π API</button>
        <button onclick="testAllSections()">üî• –¢–µ—Å—Ç –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤</button>
        <button onclick="clearLog()">üßπ –û—á–∏—Å—Ç–∏—Ç—å</button>
    </div>
    
    <div id="testResults" class="test-grid"></div>
    <div id="log"></div>

    <script type="module">
        const log = document.getElementById('log');
        const testResults = document.getElementById('testResults');
        
        let httpClient = null;
        let tradingNetworkConfigService = null;
        let testData = {};
        
        function addLog(message, type = 'normal') {
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = message;
            log.appendChild(div);
            console.log(message.replace(/<[^>]*>/g, ''));
        }
        
        function addSection(title) {
            const div = document.createElement('div');
            div.className = 'section';
            div.innerHTML = `<h3>${title}</h3>`;
            log.appendChild(div);
            return div;
        }
        
        function updateTestCard(testId, title, status, details) {
            let card = document.getElementById(`test-${testId}`);
            if (!card) {
                card = document.createElement('div');
                card.id = `test-${testId}`;
                card.className = 'test-card';
                testResults.appendChild(card);
            }
            
            const statusClass = status === 'ready' ? 'status-ready' : 
                              status === 'pending' ? 'status-pending' : 'status-error';
            
            const statusIcon = status === 'ready' ? '‚úÖ' : 
                              status === 'pending' ? '‚è≥' : '‚ùå';
            
            card.className = `test-card ${statusClass}`;
            card.innerHTML = `
                <h4>${statusIcon} ${title}</h4>
                <div class="code">${details}</div>
            `;
        }
        
        window.clearLog = function() {
            log.innerHTML = '';
            testResults.innerHTML = '';
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        async function initialize() {
            try {
                addLog('üì¶ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ HTTP –∫–ª–∏–µ–Ω—Ç–∞...', 'info');
                
                const imports = await import('/src/services/universalHttpClient.ts');
                httpClient = imports.httpClient;
                
                const configImports = await import('/src/services/tradingNetworkConfigService.ts');
                tradingNetworkConfigService = configImports.tradingNetworkConfigService;
                
                addLog('‚úÖ –°–µ—Ä–≤–∏—Å—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ', 'success');
                updateTestCard('init', '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è', 'ready', 'HTTP –∫–ª–∏–µ–Ω—Ç –∏ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                
            } catch (error) {
                addLog(`‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: ${error.message}`, 'error');
                updateTestCard('init', '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        // –¢–µ—Å—Ç 1: –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
        window.testBasicFunctionality = async function() {
            addSection('‚ö° –¢–ï–°–¢ –ë–ê–ó–û–í–û–ô –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–°–¢–ò');
            updateTestCard('basic', '–ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å', 'pending', '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...');
            
            let passed = 0;
            let total = 0;
            const details = [];
            
            try {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–∞
                total++;
                if (httpClient && typeof httpClient.get === 'function') {
                    passed++;
                    details.push('‚úÖ HTTP –∫–ª–∏–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–µ–Ω');
                } else {
                    details.push('‚ùå HTTP –∫–ª–∏–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç–æ–¥–æ–≤
                const methods = ['get', 'post', 'put', 'patch', 'delete'];
                methods.forEach(method => {
                    total++;
                    if (typeof httpClient[method] === 'function') {
                        passed++;
                        details.push(`‚úÖ –ú–µ—Ç–æ–¥ ${method.toUpperCase()} –¥–æ—Å—Ç—É–ø–µ–Ω`);
                    } else {
                        details.push(`‚ùå –ú–µ—Ç–æ–¥ ${method.toUpperCase()} –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç`);
                    }
                });
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
                const specialMethods = ['getNetworks', 'getTradingPointsByNetworkId', 'getAllTradingPointsWithNetworks'];
                specialMethods.forEach(method => {
                    total++;
                    if (typeof httpClient[method] === 'function') {
                        passed++;
                        details.push(`‚úÖ –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ ${method} –¥–æ—Å—Ç—É–ø–µ–Ω`);
                    } else {
                        details.push(`‚ùå –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ ${method} –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç`);
                    }
                });
                
                const status = passed === total ? 'ready' : 'error';
                const summary = `–ü—Ä–æ–π–¥–µ–Ω–æ: ${passed}/${total} —Ç–µ—Å—Ç–æ–≤`;
                
                updateTestCard('basic', '–ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å', status, 
                    `${summary}<br><br>${details.join('<br>')}`);
                
                addLog(`${status === 'ready' ? '‚úÖ' : '‚ùå'} –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: ${summary}`, status === 'ready' ? 'success' : 'error');
                
            } catch (error) {
                updateTestCard('basic', '–ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
                addLog(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏: ${error.message}`, 'error');
            }
        }
        
        // –¢–µ—Å—Ç 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
        window.testDatabaseIntegration = async function() {
            addSection('üóÑÔ∏è –¢–ï–°–¢ –ò–ù–¢–ï–ì–†–ê–¶–ò–ò –° –ë–ê–ó–û–ô –î–ê–ù–ù–´–•');
            updateTestCard('database', '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ë–î', 'pending', '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...');
            
            let passed = 0;
            let total = 0;
            const details = [];
            
            try {
                // –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ç–µ–π
                total++;
                addLog('üì° –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ç–µ–π...', 'info');
                const networksResponse = await httpClient.getNetworks();
                
                if (networksResponse.success && networksResponse.data && networksResponse.data.length > 0) {
                    passed++;
                    details.push(`‚úÖ –°–µ—Ç–∏: –ø–æ–ª—É—á–µ–Ω–æ ${networksResponse.data.length} –∑–∞–ø–∏—Å–µ–π`);
                    testData.networks = networksResponse.data;
                    
                    // –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Ç–æ—á–µ–∫
                    const firstNetwork = networksResponse.data[0];
                    total++;
                    addLog(`üìç –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Ç–æ—á–µ–∫ –¥–ª—è —Å–µ—Ç–∏ "${firstNetwork.name}"...`, 'info');
                    
                    const tpResponse = await httpClient.getTradingPointsByNetworkId(firstNetwork.id);
                    if (tpResponse.success && tpResponse.data) {
                        passed++;
                        details.push(`‚úÖ –¢–æ—Ä–≥–æ–≤—ã–µ —Ç–æ—á–∫–∏: –ø–æ–ª—É—á–µ–Ω–æ ${tpResponse.data.length} –∑–∞–ø–∏—Å–µ–π –¥–ª—è —Å–µ—Ç–∏ "${firstNetwork.name}"`);
                        testData.tradingPoints = tpResponse.data;
                    } else {
                        details.push(`‚ùå –¢–æ—Ä–≥–æ–≤—ã–µ —Ç–æ—á–∫–∏: –æ—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–ª—è —Å–µ—Ç–∏ "${firstNetwork.name}"`);
                    }
                } else {
                    details.push('‚ùå –°–µ—Ç–∏: –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ');
                }
                
                // –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö —Ç–æ—á–µ–∫ —Å —Å–µ—Ç—è–º–∏
                total++;
                addLog('üîç –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö —Ç–æ—á–µ–∫ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–µ—Ç—è—Ö...', 'info');
                const allTpResponse = await httpClient.getAllTradingPointsWithNetworks();
                
                if (allTpResponse.success && allTpResponse.data && allTpResponse.data.length > 0) {
                    passed++;
                    const readyCount = allTpResponse.data.filter(tp => tp.apiReady).length;
                    details.push(`‚úÖ –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¢–ü: ${allTpResponse.data.length} —Ç–æ—á–µ–∫, ${readyCount} –≥–æ—Ç–æ–≤—ã –¥–ª—è API`);
                    testData.allTradingPoints = allTpResponse.data;
                } else {
                    details.push('‚ùå –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¢–ü: –æ—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è');
                }
                
                // –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è API –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
                if (testData.allTradingPoints && testData.allTradingPoints.length > 0) {
                    const testTp = testData.allTradingPoints.find(tp => tp.apiReady) || testData.allTradingPoints[0];
                    total++;
                    addLog(`üéØ –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ API –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è "${testTp.name}"...`, 'info');
                    
                    const apiParamsResponse = await httpClient.getApiParamsForTradingPoint(testTp.id);
                    if (apiParamsResponse.success) {
                        passed++;
                        details.push(`‚úÖ API –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: system="${apiParamsResponse.systemId}", station="${apiParamsResponse.stationId}"`);
                        testData.apiParams = apiParamsResponse;
                    } else {
                        details.push(`‚ùå API –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: ${apiParamsResponse.error}`);
                    }
                }
                
                const status = passed === total ? 'ready' : passed > 0 ? 'warning' : 'error';
                const summary = `–ü—Ä–æ–π–¥–µ–Ω–æ: ${passed}/${total} —Ç–µ—Å—Ç–æ–≤`;
                
                updateTestCard('database', '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ë–î', status, 
                    `${summary}<br><br>${details.join('<br>')}`);
                
                addLog(`${status === 'ready' ? '‚úÖ' : status === 'warning' ? '‚ö†Ô∏è' : '‚ùå'} –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ë–î: ${summary}`, 
                    status === 'ready' ? 'success' : status === 'warning' ? 'warning' : 'error');
                
            } catch (error) {
                updateTestCard('database', '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ë–î', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
                addLog(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î: ${error.message}`, 'error');
            }
        }
        
        // –¢–µ—Å—Ç 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º API
        window.testExternalApiIntegration = async function() {
            addSection('üåê –¢–ï–°–¢ –ò–ù–¢–ï–ì–†–ê–¶–ò–ò –° –í–ù–ï–®–ù–ò–ú API');
            updateTestCard('external', '–í–Ω–µ—à–Ω–∏–π API', 'pending', '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...');
            
            let passed = 0;
            let total = 0;
            const details = [];
            
            try {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
                total++;
                addLog('üîß –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤–Ω–µ—à–Ω–µ–≥–æ API...', 'info');
                const config = await tradingNetworkConfigService.getConfig();
                
                if (config && config.enabled) {
                    passed++;
                    details.push(`‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: –≤–∫–ª—é—á–µ–Ω–∞, URL=${config.baseUrl}`);
                    details.push(`‚ûú Endpoints: tanks=${config.endpoints.tanks}, transactions=${config.endpoints.transactions}`);
                    details.push(`‚ûú Auth: ${config.authType}, timeout=${config.timeout}ms`);
                } else {
                    details.push('‚ùå –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: –æ—Ç–∫–ª—é—á–µ–Ω–∞ –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞');
                }
                
                // –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑–µ—Ä–≤—É–∞—Ä–æ–≤
                if (testData.apiParams) {
                    total++;
                    addLog('üõ¢Ô∏è –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∑–µ—Ä–≤—É–∞—Ä–æ–≤...', 'info');
                    
                    try {
                        const tanksData = await tradingNetworkConfigService.getTanksData(testData.apiParams.tradingPointInfo.id);
                        if (Array.isArray(tanksData) && tanksData.length > 0) {
                            passed++;
                            details.push(`‚úÖ –†–µ–∑–µ—Ä–≤—É–∞—Ä—ã: –ø–æ–ª—É—á–µ–Ω–æ ${tanksData.length} —Ä–µ–∑–µ—Ä–≤—É–∞—Ä–æ–≤`);
                        } else {
                            details.push('‚ö†Ô∏è –†–µ–∑–µ—Ä–≤—É–∞—Ä—ã: –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç (–≤–æ–∑–º–æ–∂–Ω–æ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)');
                        }
                    } catch (error) {
                        if (error.message.includes('404') || error.message.includes('Not Found')) {
                            details.push('‚ö†Ô∏è –†–µ–∑–µ—Ä–≤—É–∞—Ä—ã: 404 –æ—à–∏–±–∫–∞ (–¥–µ–º–æ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –Ω–æ –∑–∞–ø—Ä–æ—Å —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ)');
                        } else {
                            details.push(`‚ùå –†–µ–∑–µ—Ä–≤—É–∞—Ä—ã: ${error.message}`);
                        }
                    }
                    
                    // –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
                    total++;
                    addLog('üìã –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π...', 'info');
                    
                    try {
                        const transactionsData = await tradingNetworkConfigService.getTransactionsData({
                            tradingPointId: testData.apiParams.tradingPointInfo.id,
                            limit: 10
                        });
                        if (Array.isArray(transactionsData) && transactionsData.length > 0) {
                            passed++;
                            details.push(`‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: –ø–æ–ª—É—á–µ–Ω–æ ${transactionsData.length} –∑–∞–ø–∏—Å–µ–π`);
                        } else {
                            details.push('‚ö†Ô∏è –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç (–≤–æ–∑–º–æ–∂–Ω–æ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)');
                        }
                    } catch (error) {
                        if (error.message.includes('404') || error.message.includes('Not Found')) {
                            details.push('‚ö†Ô∏è –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: 404 –æ—à–∏–±–∫–∞ (–¥–µ–º–æ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –Ω–æ –∑–∞–ø—Ä–æ—Å —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ)');
                        } else {
                            details.push(`‚ùå –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: ${error.message}`);
                        }
                    }
                }
                
                const status = passed === total ? 'ready' : passed > 0 ? 'warning' : 'error';
                const summary = `–ü—Ä–æ–π–¥–µ–Ω–æ: ${passed}/${total} —Ç–µ—Å—Ç–æ–≤`;
                
                updateTestCard('external', '–í–Ω–µ—à–Ω–∏–π API', status, 
                    `${summary}<br><br>${details.join('<br>')}`);
                
                addLog(`${status === 'ready' ? '‚úÖ' : status === 'warning' ? '‚ö†Ô∏è' : '‚ùå'} –í–Ω–µ—à–Ω–∏–π API: ${summary}`, 
                    status === 'ready' ? 'success' : status === 'warning' ? 'warning' : 'error');
                
            } catch (error) {
                updateTestCard('external', '–í–Ω–µ—à–Ω–∏–π API', 'error', `–û—à–∏–±–∫–∞: ${error.message}`);
                addLog(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–Ω–µ—à–Ω–µ–≥–æ API: ${error.message}`, 'error');
            }
        }
        
        // –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤
        window.testAllSections = async function() {
            addSection('üî• –ö–û–ú–ü–õ–ï–ö–°–ù–´–ô –¢–ï–°–¢ –í–°–ï–• –†–ê–ó–î–ï–õ–û–í');
            
            addLog('üöÄ –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...', 'info');
            
            await testBasicFunctionality();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testDatabaseIntegration();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testExternalApiIntegration();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            // –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç
            addSection('üìä –ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢ –ì–û–¢–û–í–ù–û–°–¢–ò');
            
            const cards = document.querySelectorAll('.test-card');
            let readyCount = 0;
            let warningCount = 0;
            let errorCount = 0;
            
            cards.forEach(card => {
                if (card.classList.contains('status-ready')) readyCount++;
                else if (card.classList.contains('status-pending')) warningCount++;
                else errorCount++;
            });
            
            const totalTests = cards.length;
            const readyPercent = Math.round((readyCount / totalTests) * 100);
            
            let overallStatus = 'ready';
            if (errorCount > 0) overallStatus = 'error';
            else if (warningCount > 0) overallStatus = 'warning';
            
            const statusIcon = overallStatus === 'ready' ? '‚úÖ' : 
                              overallStatus === 'warning' ? '‚ö†Ô∏è' : '‚ùå';
            
            addLog(`<div class="highlight">
                ${statusIcon} –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô HTTP –ö–õ–ò–ï–ù–¢ - –ò–¢–û–ì–û–í–ê–Ø –ì–û–¢–û–í–ù–û–°–¢–¨:<br><br>
                ‚ûú –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ: ${readyCount}/${totalTests} —Ä–∞–∑–¥–µ–ª–æ–≤ (${readyPercent}%)<br>
                ‚ûú –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è: ${warningCount}<br>
                ‚ûú –û—à–∏–±–∫–∏: ${errorCount}<br><br>
                ${overallStatus === 'ready' ? 
                    'üéâ –°–ò–°–¢–ï–ú–ê –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í–ê –ö –ü–†–ò–ï–ú–£ –ó–ê–ü–†–û–°–û–í –û–¢ –†–ê–ó–î–ï–õ–û–í –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø!' :
                    overallStatus === 'warning' ?
                    '‚ö†Ô∏è –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞, –Ω–æ –µ—Å—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–æ–±—ã—á–Ω–æ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é –¥–µ–º–æ API)' :
                    '‚ùå –¢—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º'
                }
            </div>`, overallStatus === 'ready' ? 'success' : overallStatus === 'warning' ? 'warning' : 'error');
            
            updateTestCard('overall', '–û–±—â–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å', overallStatus,
                `–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: ${readyPercent}%<br>
                ‚úÖ –ì–æ—Ç–æ–≤–æ: ${readyCount}<br>
                ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è: ${warningCount}<br>
                ‚ùå –û—à–∏–±–∫–∏: ${errorCount}`);
        }
        
        // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫
        addLog('‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...', 'info');
        initialize();
    </script>
</body>
</html>